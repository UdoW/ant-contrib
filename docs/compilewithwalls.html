<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/xdoc/compilewithwalls.xml at 2020-09-28
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <meta name="author" content="Dean Hiller" />
    <title>Ant Contrib &#x2013; Compile With Walls Task</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>Ant Contrib</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-09-28<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0b6</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Ant Contrib</li>
    <li><a href="intro.html" title="Introduction"><span class="none"></span>Introduction</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
   <li class="nav-header">Logic Tasks</li>
    <li><a href="antcallback.html" title="AntCallBack"><span class="none"></span>AntCallBack</a></li>
    <li><a href="antfetch.html" title="AntFetch"><span class="none"></span>AntFetch</a></li>
    <li><a href="assert.html" title="Assert"><span class="none"></span>Assert</a></li>
    <li><a href="foreach.html" title="Foreach"><span class="none"></span>Foreach</a></li>
    <li><a href="for.html" title="For"><span class="none"></span>For</a></li>
    <li><a href="if.html" title="If"><span class="none"></span>If</a></li>
    <li><a href="outofdate.html" title="OutOfDate"><span class="none"></span>OutOfDate</a></li>
    <li><a href="relentless.html" title="Relentless"><span class="none"></span>Relentless</a></li>
    <li><a href="runtarget.html" title="RunTarget"><span class="none"></span>RunTarget</a></li>
    <li><a href="switch.html" title="Switch"><span class="none"></span>Switch</a></li>
    <li><a href="throw.html" title="Throw"><span class="none"></span>Throw</a></li>
    <li><a href="timestampselector.html" title="TimestampSelector"><span class="none"></span>TimestampSelector</a></li>
    <li><a href="trycatch.html" title="Trycatch"><span class="none"></span>Trycatch</a></li>
   <li class="nav-header">Network Tasks</li>
    <li><a href="post.html" title="HTTP Post"><span class="none"></span>HTTP Post</a></li>
    <li><a href="server_tasks.html" title="AntServer/RemoteAnt"><span class="none"></span>AntServer/RemoteAnt</a></li>
    <li><a href="importurl.html" title="ImportURL"><span class="none"></span>ImportURL</a></li>
   <li class="nav-header">Http Tasks and Types</li>
    <li><a href="http_client_type.html" title="HttpClient"><span class="none"></span>HttpClient</a></li>
    <li><a href="http_state_type.html" title="HttpState"><span class="none"></span>HttpState</a></li>
    <li><a href="post_method.html" title="PostMethod"><span class="none"></span>PostMethod</a></li>
    <li><a href="get_method.html" title="GetMethod"><span class="none"></span>GetMethod</a></li>
    <li><a href="head_method.html" title="HeadMethod"><span class="none"></span>HeadMethod</a></li>
   <li class="nav-header">Performance Monitoring and Tasks</li>
    <li><a href="performance_monitor.html" title="Performance Monitor"><span class="none"></span>Performance Monitor</a></li>
    <li><a href="stopwatch.html" title="Stopwatch"><span class="none"></span>Stopwatch</a></li>
   <li class="nav-header">Platform Tasks</li>
    <li><a href="osfamily.html" title="Osfamily"><span class="none"></span>Osfamily</a></li>
    <li><a href="shellscript.html" title="Shellscript"><span class="none"></span>Shellscript</a></li>
   <li class="nav-header">Property Tasks</li>
    <li><a href="math.html" title="Math"><span class="none"></span>Math</a></li>
    <li><a href="propertycopy.html" title="Propertycopy"><span class="none"></span>Propertycopy</a></li>
    <li><a href="propertyselector.html" title="PropertySelector"><span class="none"></span>PropertySelector</a></li>
    <li><a href="pathtofileset.html" title="Pathtofileset"><span class="none"></span>Pathtofileset</a></li>
    <li><a href="propertyregex.html" title="PropertyRegex"><span class="none"></span>PropertyRegex</a></li>
    <li><a href="sortlist.html" title="SortList"><span class="none"></span>SortList</a></li>
    <li><a href="urlencode.html" title="URLEncode"><span class="none"></span>URLEncode</a></li>
    <li><a href="variable.html" title="Variable"><span class="none"></span>Variable</a></li>
   <li class="nav-header">Process Tasks</li>
    <li><a href="forget.html" title="Forget"><span class="none"></span>Forget</a></li>
    <li><a href="limit.html" title="Limit"><span class="none"></span>Limit</a></li>
   <li class="nav-header">Other Tasks</li>
    <li><a href="antclipse.html" title="Antclipse"><span class="none"></span>Antclipse</a></li>
    <li class="active"><a href="#"><span class="none"></span>CompileWithWalls</a></li>
    <li><a href="inifile.html" title="IniFile"><span class="none"></span>IniFile</a></li>
    <li><a href="verifydesign.html" title="VerifyDesign"><span class="none"></span>VerifyDesign</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >

  
    <section>
<h2><a name="Compile_With_Walls_Task"></a>Compile With Walls Task</h2>
      <section>
<h3><a name="Deprecated"></a>Deprecated</h3>
        
<p>
          Use <a href="verifydesign.html">verifydesign</a> task
          instead.
        </p>
      </section>
      <section>
<h3><a name="Description"></a>Description</h3>
        
<p>
          Puts up walls in a the same source tree to ensure that
          designs are not violated.
        </p>
        
<p>
          This task helps someone separate out packages and prevent
          dependencies from occurring on accident. For example, if
          there are three packages in one source tree
        </p>
        
<ul>
          
<li><code>biz.xsoftware.mod</code></li>
          
<li><code>biz.xsoftware.modA</code></li>
          
<li><code>biz.xsoftware.modB</code></li>
        </ul>
        
<p>
          and <code>modB</code> and <code>modA</code> should be able
          to compiled independently, you can put a wall up in between
          the two so that if anyone adds a dependency between
          <code>modA</code> and <code>modB</code>, the build will
          break. This is particularly good if the builds are
          automated.
        </p>
        
<p>
          This task is for low level design. For architectural walls
          like client and server, I would suggest using multiple
          source trees and compiling those source trees independently
          as two different Ant <code>compile</code> targets.
        </p>
        
<p>
          One pattern I personally like to follow can be seen on the
          vmaster project on sourceforge. Instructions to check it out
          and look at are
          <a class="externalLink" href="https://sourceforge.net/cvs/?group_id=46703">HERE.</a>
          The interesting files in vmaster to look at our here...
        </p>
        
<ul>
          
<li>
            <code>vmaster/vmasterdiff/conf/build.xml</code> (Ant file
            using compilewithwalls)
          </li>
          
<li>
            <code>vmaster/vmasterdiff/conf/dependencies.xml</code>
            (The <code>compilewithwalls</code> task references this
            file as the walls)
          </li>
        </ul>
        
<p>
          Looking at some of the 2nd file
          (<code>dependencies.xml</code>), one can see apis separated
          out for many non-GUI and GUI components in these packages
        </p>
        
<ul>
          
<li><code>api.biz.xsoftware.difflib.file.*</code></li>
          
<li><code>api.biz.xsoftware.difflib.dir.*</code></li>
          
<li>more <code>api.*</code> packages</li>
          
<li><code>org.vmasterdiff.gui.dirdiff.impl.*</code></li>
        </ul>
        
<p>
          Looking closely at the <code>api.*</code> packages, each one
          has a Factory. This factory uses reflection to create the
          implementation components. Basically, the API should not
          know of the implementation so there are walls around the
          API. Reflection to instantiate the implementation gets
          around these walls. My bigger components that use the
          smaller one's use these factories. In my design you are
          guaranteed these components are replaceable. Feel free to
          checkout vmaster and look at the factories also.
        </p>
      </section>
      <section>
<h3><a name="Parameters"></a>Parameters</h3>
        
<table class="table table-striped" summary="CompileWithWalls Attributes" border="1" cellpadding="2" cellspacing="0">
          
<tr class="a">
            
<td valign="top"><b>Attribute</b></td>
            
<td valign="top"><b>Description</b></td>
            
<td align="center" valign="top"><b>Required</b></td>
          </tr>
          
<tr class="b">
            
<td valign="top">walls</td>
            
<td valign="top">
              Specifies the external dependency file to use (see
              example below)
            </td>
            
<td align="center" valign="top">
              Either this or a nested <code>walls</code> element is required
            </td>
          </tr>
          
<tr class="a">
            
<td valign="top">intermediaryBuildDir</td>
            
<td valign="top">
              Specifies scratch area for the
              <code>compilewithwalls</code> task to do the building
              and ensure dependencies are not violated
            </td>
            
<td align="center" valign="top">required</td>
          </tr>
        </table>
        </section><section>
<h3><a name="Parameters_specified_as_nested_elements"></a>Parameters specified as nested elements</h3>
        
<p>
          This task can contain one nested <code>javac</code> task and
          one nested <code>walls</code> task. See the
          <a class="externalLink" href="https://ant.apache.org/manual/Tasks/javac.html">javac
          task</a> for it's attributes and nested elements.
        </p>
      </section>
      <section>
<h3><a name="Walls_element"></a>Walls element</h3>
        
<p>
          The nested <code>walls</code> element or the &quot;walls&quot;
          attribute must be specified. Only one may be used. The
          <code>walls</code> element contains nested
          <code>package</code> elements. These nested
          <code>package</code> elements have the following
          attributes. If any package depends on another, it must be
          listed after the package it depends on in the
          <code>walls</code> element.
        </p>
        
<table class="table table-striped" summary="Walls Attributes" border="1" cellpadding="2" cellspacing="0">
          
<tr class="a">
            
<td valign="top"><b>Attribute</b></td>
            
<td valign="top"><b>Description</b></td>
            
<td align="center" valign="top"><b>Required</b></td>
          </tr>
          
<tr class="b">
            
<td valign="top">name</td>
            
<td valign="top">
              A smaller nickname for the package to reference in
              depends.
            </td>
            
<td align="center" valign="top">Required</td>
          </tr>
          
<tr class="a">
            
<td valign="top">package</td>
            
<td valign="top">
              The package to compile such as
              <code>biz.xsoftware.*</code> to include the immediate
              package only or <code>biz.xsoftware.**</code> to include
              <code>biz.xsoftware</code> and all subpackages.
            </td>
            
<td align="center" valign="top">Required</td>
          </tr>
          
<tr class="b">
            
<td valign="top">depends</td>
            
<td valign="top">
              If a package needs one of the previously specified
              packages to compile, it's name should be added here in a
              comma separated list. For example
              <code>depends=&quot;modA,modB&quot;</code>.
            </td>
            
<td align="center" valign="top">Optional</td>
          </tr>
        </table>
      </section>
      <section>
<h3><a name="Examples"></a>Examples</h3>
        
<p>
          In the examples, I will show the <code>javac</code> as a
          null element, because it's use is documented in the
          <a class="externalLink" href="https://ant.apache.org/manual/Tasks/javac.html">javac
          task</a> documentation.
        </p>
        <section>
<h4><a name="Walls_Nested_Element..."></a>Walls Nested Element...</h4>
        
<div class="source"><pre class="prettyprint">&lt;compilewithwalls&gt;
  &lt;walls&gt;
     &lt;package name=&quot;modA&quot; package=&quot;biz.xsoftware.mod.modA.**&quot;/&gt;
     &lt;package name=&quot;modB&quot; package=&quot;biz.xsoftware.mod.modB.*&quot;/&gt;
     &lt;package name=&quot;mod&quot; package=&quot;biz.xsoftware.mod.modA.*&quot; depends=&quot;modA,modB&quot;/&gt;
  &lt;/walls&gt;
  &lt;javac&gt;&lt;/javac&gt;
&lt;/compilewithwalls&gt;</pre></div>
        
<p>
          Notice that the package named <code>mod</code> had to come
          after the packages it depended on. Now if anybody puts code
          in <code>modA</code> that uses classes in <code>modB</code>,
          the build will break telling them they are violating a
          design constraint. I personally have had many a developer
          accidentally put dependencies in that we agreed in the
          design should not be there. This includes myself. This
          prevents this from happening as long as someone doesn't
          change the Ant build file... If someone does though, at
          least you can view the package dependencies and now what
          they are.
        </p>
        </section><section>
<h4><a name="Walls_attribute..."></a>Walls attribute...</h4>
        
<p>These next lines would be in <code>build.xml</code>...</p>
        
<div class="source"><pre class="prettyprint">&lt;compilewithwalls walls=&quot;dependencies.xml&quot;&gt;
  &lt;javac&gt;&lt;/javac&gt;
&lt;/compilewithwalls&gt;</pre></div>
        
<p>These lines would be in <code>dependencies.xml</code>...</p>
        
<div class="source"><pre class="prettyprint">&lt;walls&gt;
  &lt;package name=&quot;modA&quot; package=&quot;biz.xsoftware.mod.modA.**&quot;/&gt;
  &lt;package name=&quot;modB&quot; package=&quot;biz.xsoftware.mod.modB.*&quot;/&gt;
  &lt;package name=&quot;mod&quot; package=&quot;biz.xsoftware.mod.modA.*&quot; depends=&quot;modA,modB&quot;/&gt;
&lt;/walls&gt;</pre></div>
      </section></section>
    </section>
  

        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2001&#x2013;2020
<a href="https://github.com/top-logic/ant-contrib/">Ant-Contrib Project</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
